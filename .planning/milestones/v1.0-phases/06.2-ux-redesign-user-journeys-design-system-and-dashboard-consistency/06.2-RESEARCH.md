# Phase 6.2: UX Redesign â€” User Journeys, Design System & Dashboard Consistency - Research

**Researched:** 2026-02-11
**Scope:** Comprehensive UX redesign with properly defined user journeys, consistent design system, onboarding flows, page structure separation, and enhanced 3D elements for both dashboards

---

## Executive Summary

This research addresses critical UX/UI gaps identified after Phase 6.1 execution. The phase focuses on frontend design and implementation refinement with no new backend functionality. Key findings:

1. **Design System Architecture:** Shadcn/ui + Radix UI + Tailwind CSS is the optimal stack for 2026, providing ownership, accessibility, and glassmorphism support
2. **User Journey Mapping:** Civic tech requires distinct flows for citizen registration, municipal onboarding, and role-based dashboard adaptation
3. **3D Globe Quality:** Current implementation needs upgrade to stylized premium quality using advanced Three.js materials and performance optimization
4. **Progressive Disclosure:** Multi-step wizards and adaptive navigation are essential for municipality onboarding and citizen registration
5. **Accessibility:** WCAG 2.3.3 compliance requires prefers-reduced-motion support for all animations
6. **South African Context:** Ndebele/Zulu geometric patterns provide culturally relevant design inspiration

---

## 1. Design System Implementation Strategy

### 1.1 Recommended Architecture: Shadcn/ui + Radix + Tailwind

**Why This Stack:**
- **Ownership:** Unlike traditional component libraries, shadcn/ui copies components into your codebase, giving you full control
- **Accessibility:** Built on Radix UI primitives with battle-tested keyboard navigation and ARIA patterns
- **Performance:** Tree-shakeable, minimal bundle size, no runtime overhead
- **2026 Industry Standard:** 78% of professional React developers use TypeScript + component systems like this
- **Glassmorphism Support:** Easy to implement glassmorphism variants on top of Radix primitives

**Architecture Principles (from research):**
- Radix UI provides unstyled, accessible primitives (Dialog, Popover, ScrollArea, etc.)
- Tailwind CSS provides utility-first styling with design token system
- Shadcn/ui provides pre-built components combining Radix + Tailwind that you own
- All components use shared CSS variables (--primary, --background, --foreground) for theme consistency
- Copy components into codebase, modify as needed â€” no package.json dependency lock-in

**Implementation for Phase 6.2:**
```typescript
// shared/tokens.ts - Design token constants
export const colors = {
  navy: '#0A0E1A',           // Deep background
  navySurface: '#1A1F3A',    // Card surfaces
  coral: '#FF6B4A',          // Primary CTA
  coralHover: '#FF8566',
  teal: '#00D9A6',           // Secondary accent
  tealHover: '#00F0B8',
  textPrimary: '#E8E8EC',
  textSecondary: '#9CA3AF',
  surfaceElevated: 'rgba(255,255,255,0.05)',
  border: 'rgba(255,255,255,0.1)',
};

// Shared glassmorphism component pattern
export const glassCard = {
  background: 'rgba(26, 31, 58, 0.6)',
  backdropFilter: 'blur(16px)',
  border: '1px solid rgba(255,255,255,0.1)',
  boxShadow: '0 8px 32px rgba(0, 0, 0, 0.3)',
};
```

**Sources:**
- [Shadcn UI Foundation](https://ui.shadcn.com/)
- [Shadcn UI Best Practices 2026](https://medium.com/write-a-catalyst/shadcn-ui-best-practices-for-2026-444efd204f44)
- [React UI with Radix + Tailwind](https://vercel.com/academy/shadcn-ui)
- [TypeScript with React Best Practices 2026](https://medium.com/@mernstackdevbykevin/typescript-with-react-best-practices-2026-78ce4546210b)

### 1.2 Glassmorphism Implementation

**Current State:** Municipal dashboard login card uses glassmorphism and is loved by user. This must become a reusable pattern.

**Glassmorphism Libraries for React (2026):**
- **Liquid Glass UI:** Tailwind + React + Next.js, includes Button, Card, Modal, Table components
- **glasscn-ui:** Shadcn/ui with glassmorphism variants built-in
- **GlassyUI:** Open-source library with glassmorphism-themed components

**Recommended Approach:**
Don't add a library dependency â€” create your own glassmorphism component variants using the existing login card as reference. Build on shadcn/ui primitives with custom Tailwind classes.

**Implementation Pattern:**
```tsx
// components/ui/GlassCard.tsx
interface GlassCardProps {
  children: React.ReactNode;
  className?: string;
  variant?: 'default' | 'elevated' | 'interactive';
}

export function GlassCard({ children, className, variant = 'default' }: GlassCardProps) {
  const variants = {
    default: 'bg-glass-base backdrop-blur-md border-glass',
    elevated: 'bg-glass-elevated backdrop-blur-lg border-glass-bright',
    interactive: 'bg-glass-base backdrop-blur-md border-glass hover:border-glass-bright transition-all',
  };

  return (
    <div className={cn(variants[variant], 'rounded-xl', className)}>
      {children}
    </div>
  );
}
```

**CSS Variables for Glassmorphism:**
```css
/* shared/design-tokens.css */
:root {
  --glass-bg: rgba(26, 31, 58, 0.6);
  --glass-elevated: rgba(26, 31, 58, 0.8);
  --glass-border: rgba(255, 255, 255, 0.1);
  --glass-border-bright: rgba(255, 255, 255, 0.2);
  --glass-blur: 16px;
}
```

**Sources:**
- [Liquid Glass UI](https://liquidglass.liqueai.com/)
- [glasscn-ui GitHub](https://github.com/itsjavi/glasscn-ui)
- [Glassmorphism in 2026](https://invernessdesignstudio.com/glassmorphism-what-it-is-and-how-to-use-it-in-2026)

### 1.3 Shared Design System Between Two Apps

**Current Challenge:** Two independent Vite apps (frontend-dashboard and frontend-public) need consistent design language.

**Recommended Pattern: Monorepo-lite with Shared Directory**

```
salga-trust-engine/
â”œâ”€â”€ shared/
â”‚   â”œâ”€â”€ design-tokens.css      # CSS custom properties
â”‚   â”œâ”€â”€ tokens.ts              # TypeScript design tokens
â”‚   â”œâ”€â”€ components/            # Shared React components
â”‚   â”‚   â”œâ”€â”€ ui/                # Shadcn/ui components
â”‚   â”‚   â”‚   â”œâ”€â”€ GlassCard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Skeleton.tsx
â”‚   â”‚   â””â”€â”€ Globe3D.tsx        # Shared 3D globe component
â”‚   â””â”€â”€ lib/
â”‚       â””â”€â”€ utils.ts           # Shared utilities (cn, etc.)
â”œâ”€â”€ frontend-dashboard/
â”‚   â””â”€â”€ src/
â”‚       â””â”€â”€ imports shared components via relative paths
â””â”€â”€ frontend-public/
    â””â”€â”€ src/
        â””â”€â”€ imports shared components via relative paths
```

**Import Pattern:**
```typescript
// In both apps
import { GlassCard } from '../../../shared/components/ui/GlassCard';
import { colors, typography } from '../../../shared/tokens';
import '../../../shared/design-tokens.css';
```

**TypeScript Configuration:**
```json
// tsconfig.json for both apps
{
  "compilerOptions": {
    "paths": {
      "@shared/*": ["../../../shared/*"]
    }
  }
}
```

**Sources:**
- [Building Reusable React Components 2026](https://medium.com/@romko.kozak/building-reusable-react-components-in-2026-a461d30f8ce4)

---

## 2. User Journey Mapping for Civic Tech

### 2.1 Journey Mapping Principles

**Definition (from research):**
Journey mapping is the process of revealing the full story of the citizen experience from beginning to end. A citizen journey map is a visualization of a person's process, end-to-end, to accomplish a goal.

**Key Benefits for Government Applications:**
- Identifies pain points across different demographic groups
- Reduces friction and boosts completion rates
- Shows how a service fits into a bigger picture
- Highlights what other things might need to change

**Structure:**
Journey maps include:
- **"Above ground" layer:** Customer actions like going to a website or office
- **"Below ground" layer:** Actions invisible to citizen performed by government employees

**Sources:**
- [Citizen Journey Mapping in Government](https://www.smaply.com/blog/journey-mapping-government)
- [Journey Mapping in State and Local Government](https://statetechmagazine.com/article/2024/08/what-journey-mapping-and-how-it-used-state-and-local-government-perfcon)
- [Nivaro: Simplifying Civic Reporting](https://medium.com/dtalks/nivaro-how-i-simplified-civic-reporting-for-millions-a-ui-ux-design-story-ba9c4243c0cd)
- [Why We Use Journey Maps in Government](https://designnotes.blog.gov.uk/2016/03/30/why-we-use-user-journey-maps-in-government/)

### 2.2 Municipality Journey: Hybrid Registration + Guided Onboarding

**Registration Flow (Hybrid Model):**
1. Municipality admin visits landing page
2. Clicks "Request Access" (not "Sign Up" â€” requires approval)
3. Fills web form: municipality name, province, contact details, supporting documents
4. Submit request â†’ "Thank you, under review" confirmation
5. SALGA platform admin reviews request in admin dashboard
6. Admin approves/rejects with notification email
7. On approval: municipality receives invite link via email
8. Admin clicks invite â†’ lands on secure signup page (pre-filled email, set password)
9. Account created â†’ redirected to onboarding wizard

**Why Hybrid (Not Open Signup):**
- Prevents spam registrations
- Verifies legitimate municipalities
- Allows SALGA to control rollout (pilot cohort approach)
- Enables vetting of supporting documents

**Onboarding Wizard (Step-by-Step with Progress Tracking):**

```
Step 1: Welcome
- Brief intro video/animation
- "Let's get your municipality set up"
- Estimated time: 5 minutes
- [Start Setup] button

Step 2: Profile Setup
- Municipality details: full name, code, province, contact info
- Logo upload (optional)
- Primary contact person
- Progress: [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘] 25%

Step 3: Invite Team Members
- Add team members: email, role (manager/councillor/worker)
- Bulk CSV upload option
- "You can always add more later"
- Skip button available
- Progress: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] 50%

Step 4: Configure Wards
- Interactive map to draw ward boundaries (simplified)
- Or CSV upload with ward names and geofences
- "This helps route tickets to the right teams"
- Progress: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘] 75%

Step 5: Set SLA Targets
- Response time target (default: 24 hours)
- Resolution time target (default: 7 days)
- "You can adjust these anytime in Settings"
- Progress: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100%

Step 6: Done!
- Celebration animation
- "Your dashboard is ready"
- [Go to Dashboard] button
- Saves progress state so can resume if interrupted
```

**Technical Implementation:**
- Wizard state stored in Zustand or local storage with session sync
- Progress tracked in backend `municipality_onboarding_status` table
- Can resume wizard if interrupted (state persisted)
- Final step marks onboarding as complete

**Sources:**
- [UX Onboarding Best Practices 2026](https://www.uxdesigninstitute.com/blog/ux-onboarding-best-practices-guide/)
- [Progressive Onboarding Guide](https://userguiding.com/blog/progressive-onboarding)

### 2.3 Citizen Journey: Web + WhatsApp Unified

**Registration Flow (Both Channels Lead to Same Account):**

**Web Registration:**
1. Citizen visits public dashboard â†’ clicks "Report Issue"
2. Redirects to login page â†’ "Don't have an account? Register"
3. Registration form:
   - Email or phone number (unique identifier)
   - ID number (for verification)
   - Proof of residence upload (PDF/image)
   - Terms & POPIA consent checkboxes
4. Submit â†’ OCR processes proof of residence in background
5. "Account under review" confirmation page
6. OCR confidence >= 0.7: Auto-verify â†’ email/SMS notification â†’ account activated
7. OCR confidence < 0.7: Manual review by municipality admin

**WhatsApp Registration (Conversational):**
1. Citizen sends "Hi" to municipality WhatsApp number
2. Bot: "Welcome! First time? Let's create your account."
3. Bot asks: Email or phone?
4. Bot asks: ID number?
5. Bot: "Please send photo of proof of residence (utility bill, lease agreement)"
6. Citizen uploads photo
7. Bot: "Processing... Account under review. We'll notify you when verified."
8. Same OCR pipeline as web registration
9. Once verified: "Account activated! You can now report issues."

**Key Design Principle: Unified Backend**
- Both flows create identical `User` records
- Both flows use same OCR verification pipeline
- Account is tied to municipality (tenant_id) based on proof of residence address
- Citizen can use web portal OR WhatsApp after registration

**Reporting Flow (Authenticated):**
1. Citizen logs in (web) or verified (WhatsApp)
2. Reports issue via preferred channel
3. Ticket created with citizen_id link
4. Citizen can track ticket on web portal "My Reports" page OR via WhatsApp status updates

**Sources:**
- [Mobile Onboarding Best Practices 2026](https://www.designstudiouiux.com/blog/mobile-app-onboarding-best-practices/)

### 2.4 Role-Based Dashboard Adaptation

**Challenge:** Municipal dashboard must adapt to different user roles without overwhelming users with irrelevant features.

**Roles & Their Dashboard Views:**

| Role | Navigation Items | Access Control |
|------|------------------|----------------|
| **Platform Admin** | All municipalities, cross-tenant analytics, municipality management, system settings | All features, cross-tenant queries |
| **Municipality Manager** | Tickets (all), Teams, Analytics (full), Settings (all), SLA monitoring, Wards | Full municipality access |
| **Ward Councillor** | Tickets (ward-filtered), Analytics (ward-filtered), Teams (ward-filtered) | Ward-scoped queries only |
| **Field Worker** | Tickets (assigned to me), My Schedule, Submit Report | Own assignments only |
| **SAPS Liaison** | GBV Cases (only), SAPS-specific analytics | GBV tickets only (is_sensitive=true) |

**Implementation Pattern: Adaptive Navigation**

```typescript
// hooks/useRoleBasedNav.ts
export function useRoleBasedNav(role: UserRole) {
  const navItems = useMemo(() => {
    const base = [
      { label: 'Dashboard', path: '/', icon: Home },
    ];

    if (role === 'platform_admin') {
      return [...base,
        { label: 'Municipalities', path: '/municipalities', icon: Building },
        { label: 'System', path: '/system', icon: Settings },
      ];
    }

    if (role === 'manager') {
      return [...base,
        { label: 'Tickets', path: '/tickets', icon: Ticket },
        { label: 'Teams', path: '/teams', icon: Users },
        { label: 'Analytics', path: '/analytics', icon: Chart },
        { label: 'Settings', path: '/settings', icon: Settings },
      ];
    }

    if (role === 'ward_councillor') {
      return [...base,
        { label: 'My Ward Tickets', path: '/tickets', icon: Ticket },
        { label: 'Ward Analytics', path: '/analytics', icon: Chart },
      ];
    }

    if (role === 'field_worker') {
      return [
        { label: 'My Tickets', path: '/', icon: Ticket },
        { label: 'Submit Report', path: '/submit', icon: Upload },
      ];
    }

    if (role === 'saps_liaison') {
      return [
        { label: 'GBV Cases', path: '/', icon: ShieldAlert },
        { label: 'Reports', path: '/reports', icon: FileText },
      ];
    }

    return base;
  }, [role]);

  return navItems;
}
```

**Navigation UI Pattern:**
- Icon-only sidebar by default (collapsed, ~64px wide)
- Hover expands to show labels (~240px wide)
- Mobile: hamburger menu
- Role badge displayed in user profile dropdown

**Sources:**
- [React Admin Dashboard 2026 Guide](https://refine.dev/blog/react-admin-dashboard/)
- [Role-Based Menu in React](https://www.sevensquaretech.com/role-based-menu-reactjs-with-github-code/)

### 2.5 Citizen Authenticated Web Portal

**"My Reports" Dashboard Features:**

```
Layout:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SALGA Trust Engine  [Profileâ–¼] [Logout]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  My Reports                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ [Report New Issue] (coral button)       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                  â”‚
â”‚  Personal Stats (glassmorphism cards)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ 12       â”‚ â”‚ 9        â”‚ â”‚ 2.3 days â”‚        â”‚
â”‚  â”‚ Total    â”‚ â”‚ Resolved â”‚ â”‚ Avg Time â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                  â”‚
â”‚  Ticket List                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ TKT-20260211-A3F9B2  [In Progress]      â”‚    â”‚
â”‚  â”‚ Pothole on Main Street                   â”‚    â”‚
â”‚  â”‚ Reported: 2 days ago â€¢ Ward 5            â”‚    â”‚
â”‚  â”‚ Assigned to: John Doe (Field Worker)     â”‚    â”‚
â”‚  â”‚ [View Details]                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ TKT-20260209-B2C8A1  [ğŸ”’ Private]       â”‚    â”‚
â”‚  â”‚ GBV Case (limited info)                  â”‚    â”‚
â”‚  â”‚ Status: Under Investigation               â”‚    â”‚
â”‚  â”‚ Assigned SAPS: Cpt. M. Nkosi             â”‚    â”‚
â”‚  â”‚ Station: Hillbrow (011-123-4567)         â”‚    â”‚
â”‚  â”‚ [Emergency: 10111]                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                  â”‚
â”‚  Comparison (optional):                          â”‚
â”‚  "Your avg resolution time: 2.3 days"           â”‚
â”‚  "Municipality avg: 3.1 days"                   â”‚
â”‚  "You're 25% faster than average"               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**GBV Case Visibility Design:**
- Lock icon ğŸ”’ indicates privacy
- Limited information shown:
  - Status (Open, Under Investigation, Resolved)
  - Assigned SAPS officer name and rank
  - Police station name and phone number
  - Emergency numbers prominently displayed (10111, 0800 150 150)
- No address, no photos, no detailed description visible
- Enables victim to follow up directly with assigned officer
- Transparency without compromising safety

**Why This Matters:**
- Empowers citizen to track progress
- Provides direct contact for follow-up
- Maintains privacy (no case details exposed)
- Always accessible emergency contacts

---

## 3. Progressive Disclosure & Onboarding Best Practices

### 3.1 Core Principles

**Definition (from research):**
Progressive disclosure is a UX design technique that reduces users' cognitive load by gradually revealing information as needed, commonly used to simplify complex content or break down large amounts of information into digestible bits.

**Key Benefits:**
- Improve customer experiences for new users
- Simplify the user interface
- Create better understanding of initial and secondary features
- Reduce the learning curve

**Best Practices (from research):**

1. **Limit Information Display**
   - Show only core and secondary features initially
   - Defer advanced or rarely-used features
   - Focus on bare minimum needed to get started

2. **Step-by-Step Approach**
   - Present one question per screen
   - Minimize cognitive load by focusing on one task at a time
   - Favor multiple screens over one long page

3. **Contextual Help**
   - Make help visible but not overwhelming
   - Only show detail when user requests it
   - Use tooltips, popovers, and inline hints

4. **Visual Aids and Minimal Copy**
   - Users read ~20% of text
   - Short-term memory holds 7Â±2 items for ~30 seconds
   - Reduce copy, use visuals whenever possible

5. **Multiple UX Patterns**
   - Use checklists to break down complexity
   - Each checklist item opens a new screen
   - Guide through core features without overwhelm

**Sources:**
- [Progressive Disclosure Examples](https://userpilot.com/blog/progressive-disclosure-examples/)
- [Progressive Disclosure in UX Design](https://blog.logrocket.com/ux-design/progressive-disclosure-ux-types-use-cases/)
- [Progressive Onboarding Guide](https://userguiding.com/blog/progressive-onboarding)

### 3.2 Multi-Step Wizard Implementation

**Recommended React Pattern:**

```typescript
// components/OnboardingWizard.tsx
interface WizardStep {
  id: string;
  title: string;
  description: string;
  component: React.ComponentType<StepProps>;
  validation?: (data: any) => boolean;
  optional?: boolean;
}

function OnboardingWizard({ steps }: { steps: WizardStep[] }) {
  const [currentStep, setCurrentStep] = useState(0);
  const [wizardData, setWizardData] = useState<Record<string, any>>({});

  const progress = ((currentStep + 1) / steps.length) * 100;

  return (
    <div className="wizard-container">
      {/* Progress Bar */}
      <div className="progress-bar">
        <div className="progress-fill" style={{ width: `${progress}%` }} />
        <span className="progress-text">
          Step {currentStep + 1} of {steps.length}
        </span>
      </div>

      {/* Step Content */}
      <div className="step-content">
        {React.createElement(steps[currentStep].component, {
          data: wizardData[steps[currentStep].id],
          onUpdate: (data) => setWizardData({
            ...wizardData,
            [steps[currentStep].id]: data,
          }),
        })}
      </div>

      {/* Navigation */}
      <div className="wizard-nav">
        <Button
          variant="outline"
          onClick={() => setCurrentStep(currentStep - 1)}
          disabled={currentStep === 0}
        >
          Back
        </Button>
        <Button
          onClick={() => {
            if (currentStep === steps.length - 1) {
              onComplete(wizardData);
            } else {
              setCurrentStep(currentStep + 1);
            }
          }}
        >
          {currentStep === steps.length - 1 ? 'Complete' : 'Next'}
        </Button>
      </div>
    </div>
  );
}
```

**Progress Persistence:**
```typescript
// Save progress to backend on each step completion
async function saveWizardProgress(municipalityId: string, stepId: string, data: any) {
  await supabase
    .from('municipality_onboarding_state')
    .upsert({
      municipality_id: municipalityId,
      step_id: stepId,
      step_data: data,
      updated_at: new Date().toISOString(),
    });
}

// Resume wizard on return
async function loadWizardProgress(municipalityId: string) {
  const { data } = await supabase
    .from('municipality_onboarding_state')
    .select('*')
    .eq('municipality_id', municipalityId);

  return data; // Restore wizard state
}
```

**Sources:**
- [Wizard Onboarding UX Examples](https://userpilot.com/blog/onboarding-ux-examples/)

---

## 4. Enhanced 3D Elements & Performance

### 4.1 Current 3D Implementation Issues

**Problem:** Current 3D globe (Phase 6.1) looks "too basic/low quality" per user feedback.

**Current Stack:**
- Three.js ^0.182.0
- @react-three/fiber ^9.5.0
- @react-three/drei ^10.7.7
- d3-geo ^3.1.1
- topojson for SA GeoJSON

**What Needs Improvement:**
- Material quality (currently basic MeshStandardMaterial)
- Lighting setup (needs more dramatic lighting)
- Particle effects and glowing data points
- Post-processing effects (bloom, glow)
- Animation polish (rotation speed, camera movements)

### 4.2 Stylized Premium Globe Design

**Recommended Approach: Custom Artistic Globe (Not Photorealistic)**

**Material Upgrade:**
```typescript
// Current: Basic material
<meshStandardMaterial color="#1A1F3A" />

// Upgrade: Custom material with properties
<meshPhysicalMaterial
  color="#1A1F3A"
  metalness={0.7}         // Metallic sheen
  roughness={0.2}         // Glossy finish
  clearcoat={1.0}         // Glass-like top layer
  clearcoatRoughness={0.1}
  envMapIntensity={1.5}   // Reflects environment
  transmission={0.1}      // Slight translucency
/>
```

**Advanced Techniques (from research):**
- Use `onBeforeCompile` to modify shader code for custom effects
- Leverage `MeshPhysicalMaterial` for realistic lighting calculations
- Add environment maps for reflections
- Use `ShaderMaterial` for fully custom stylized effects

**Particle Effects for Municipality Points:**
```typescript
// Glowing data points for each municipality location
<Points>
  <pointsMaterial
    size={0.05}
    color={colors.coral}
    opacity={0.8}
    transparent
    blending={AdditiveBlending}  // Creates glow effect
  />
</Points>
```

**Post-Processing (Optional):**
```typescript
import { EffectComposer, Bloom } from '@react-three/postprocessing';

<EffectComposer>
  <Bloom
    intensity={1.5}
    luminanceThreshold={0.4}
    luminanceSmoothing={0.9}
  />
</EffectComposer>
```

**Sources:**
- [React-Globe.gl](https://github.com/vasturiano/react-globe.gl)
- [Three-Globe npm](https://www.npmjs.com/package/three-globe)
- [Make Your Own Earth in Three.js](https://franky-arkon-digital.medium.com/make-your-own-earth-in-three-js-8b875e281b1e)

### 4.3 Mobile Performance Optimizations

**CRITICAL: Current Phase 6.1 has these optimizations. Phase 6.2 must maintain them.**

**Existing Optimizations to Preserve:**
1. **Canvas Resolution Scaling:** `dpr={[1, Math.min(devicePixelRatio, 2)]}`
2. **On-Demand Rendering:** `frameloop="demand"`
3. **Low-Poly Geometry:** GeoJSON simplified with topojson-simplify
4. **GPU Tier Detection:** detect-gpu adjusts quality
5. **Shader Precision:** mediump for colors/normals
6. **Lazy Loading:** React.lazy() + Suspense for 3D components

**Additional Optimizations for Phase 6.2:**

**LOD (Level of Detail):**
```typescript
import { Detailed } from '@react-three/drei';

<Detailed distances={[0, 50, 100]}>
  <HighDetailGlobe />   {/* Desktop close-up */}
  <MediumDetailGlobe /> {/* Desktop far */}
  <LowDetailGlobe />    {/* Mobile */}
</Detailed>
```

**Geometry Instancing for Municipality Points:**
```typescript
// Instead of creating 100+ individual meshes, use instancing
<instancedMesh args={[geometry, material, municipalityCount]}>
  {/* Position each instance via matrix transforms */}
</instancedMesh>
```

**Frustum Culling:**
Ensure globe parts outside camera view are not rendered (Three.js does this by default, but verify it's not disabled).

**Sources:**
- [R3F Scaling Performance](https://r3f.docs.pmnd.rs/advanced/scaling-performance)
- [100 Three.js Tips 2026](https://www.utsubo.com/blog/threejs-best-practices-100-tips)

### 4.4 3D Placement Strategy

**Landing Page Hero (Public Dashboard):**
- Full-viewport 3D globe as hero background
- Stylized, premium, draws attention
- Slow auto-rotation
- Hover to pause, click to explore
- Glassmorphism overlay for text

**Transparency Dashboard (Public Dashboard):**
- Same 3D globe reused as interactive data visualization
- Municipality locations as glowing points
- Click point â†’ drill into municipality data
- Color-coded by performance (green = good, orange = needs improvement, red = poor)

**Municipal Dashboard:**
- NO 3D globe on main dashboard (2D maps and charts only)
- 3D globe only on login page (decorative)
- Performance reason: Municipal dashboard is data-heavy, no need for 3D overhead

**Why This Strategy:**
- Public dashboard is marketing + transparency â†’ 3D enhances storytelling
- Municipal dashboard is operational tool â†’ focus on data clarity
- Reuses 3D globe asset across two public pages â†’ efficient bundle size

---

## 5. GSAP Scroll Animations & Cinematic Storytelling

### 5.1 Current Implementation (Phase 6.1)

**What's Already Built:**
- GSAP 3.14.2 + @gsap/react 2.1.2
- Lenis 1.3.17 smooth scroll
- ScrollTrigger animations in 7 landing sections
- anime.js for counter animations
- React.lazy() code-splitting for animations

**Phase 6.1 Landing Page Sections:**
1. HeroSection â€” 3D globe, headline animation
2. ProblemSection â€” Text reveal on scroll
3. SolutionSection â€” Split-screen transition
4. FeaturesSection â€” Staggered card animations
5. LiveStatsSection â€” Counter animations (anime.js)
6. MunicipalityShowcase â€” Horizontal scroll carousel
7. DashboardPreview â€” Zoom transition to live dashboard

### 5.2 Enhancement Opportunities for Phase 6.2

**Cinematic Scroll Storytelling Best Practices (from research):**

**Key Findings:**
- Treat scroll as a director's cue, guiding viewer attention through space, light, and motion
- Well-designed scroll animations see 47% higher engagement rates and 34% longer session durations
- GSAP ScrollTrigger is the gold standard for pixel-perfect control
- RequestAnimationFrame + CSS transforms ensure 60fps smooth animations

**Implementation Pattern:**
```typescript
import { useGSAP } from '@gsap/react';
import { ScrollTrigger } from 'gsap/ScrollTrigger';

gsap.registerPlugin(useGSAP, ScrollTrigger);

function CinematicSection() {
  const container = useRef<HTMLDivElement>(null);

  useGSAP(() => {
    // Parallax effect
    gsap.to('.background-layer', {
      y: -100,
      ease: 'none',
      scrollTrigger: {
        trigger: container.current,
        start: 'top bottom',
        end: 'bottom top',
        scrub: true, // Links animation to scroll position
      },
    });

    // Reveal animation
    gsap.from('.content-card', {
      y: 100,
      opacity: 0,
      duration: 1,
      stagger: 0.2,
      scrollTrigger: {
        trigger: '.content-card',
        start: 'top 80%',
        toggleActions: 'play none none reverse',
      },
    });
  }, { scope: container });

  return <div ref={container}>...</div>;
}
```

**Animation Timing Best Practices:**
- Use `scrub: true` for parallax effects (links to scroll position)
- Use `stagger` for sequential reveals (0.1-0.2s intervals)
- Use `ease: 'power2.out'` for smooth deceleration
- Use `toggleActions: 'play none none reverse'` for bidirectional animations

**Sources:**
- [Cinematic 3D Scroll with GSAP](https://tympanus.net/codrops/2025/11/19/how-to-build-cinematic-3d-scroll-experiences-with-gsap/)
- [Scroll Storytelling Web Design Trend 2026](https://www.skyadesigns.co.uk/web-design-insights/web-design-trend-2026-scroll-storytelling/)
- [GSAP Scroll Documentation](https://gsap.com/scroll/)

### 5.3 Accessibility: prefers-reduced-motion

**WCAG 2.3.3 Requirement:**
Motion animation triggered by interaction can be disabled unless the animation is essential to functionality.

**Implementation:**
```typescript
// Detect user preference
const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

useGSAP(() => {
  if (prefersReducedMotion) {
    // Disable complex animations
    gsap.set('.animated-element', { opacity: 1, y: 0 });
  } else {
    // Full animation
    gsap.from('.animated-element', {
      y: 100,
      opacity: 0,
      duration: 1,
      scrollTrigger: { ... },
    });
  }
}, { dependencies: [prefersReducedMotion] });
```

**CSS Approach:**
```css
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}
```

**Best Practice:**
- Always respect `prefers-reduced-motion`
- Fallback to instant transitions or subtle fades
- Keep essential animations (loading spinners, progress indicators)
- Remove decorative animations (parallax, scroll reveals)

**Sources:**
- [Animation & Motion Accessibility](https://www.atomica11y.com/accessible-design/animation/)
- [WCAG 2.3.3 Animation from Interactions](https://www.w3.org/WAI/WCAG21/Understanding/animation-from-interactions.html)
- [CSS prefers-reduced-motion](https://www.w3.org/WAI/WCAG21/Techniques/css/C39)

---

## 6. Dark Mode Animated Gradient Background

### 6.1 Current Implementation

**Phase 6.1 State:**
- Static dark navy background (`#0A0E1A`)
- Design tokens defined in `shared/design-tokens.css`

**Phase 6.2 Requirement:**
- Animated gradient that rotates through 3 different gradient color schemes
- Smooth, subtle, not distracting
- Must perform well on mobile

### 6.2 Implementation Strategy

**Gradient Animation Techniques (from research):**

**Technique 1: Background-Position Animation (Recommended)**
```css
@keyframes gradientShift {
  0%, 100% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
}

.animated-gradient {
  background: linear-gradient(
    270deg,
    #0A0E1A,  /* Navy */
    #1A1F3A,  /* Navy surface */
    #0F1523,  /* Dark blue-grey */
    #0A0E1A   /* Back to navy */
  );
  background-size: 400% 400%;
  animation: gradientShift 15s ease infinite;
}
```

**Technique 2: Multiple Gradients with Opacity Transitions**
```css
.gradient-layer-1 {
  background: linear-gradient(135deg, #0A0E1A, #1A1F3A);
  animation: fadeInOut 20s ease-in-out infinite;
}

.gradient-layer-2 {
  background: linear-gradient(225deg, #0F1523, #131829);
  animation: fadeInOut 20s ease-in-out infinite 6.67s;
}

.gradient-layer-3 {
  background: linear-gradient(315deg, #121721, #1A1F3A);
  animation: fadeInOut 20s ease-in-out infinite 13.33s;
}

@keyframes fadeInOut {
  0%, 33%, 100% { opacity: 0; }
  16%, 66% { opacity: 1; }
}
```

**Performance Considerations (from research):**
- CSS animations are less resource-intensive than JavaScript
- Complex animated gradients can affect performance
- Testing and optimizing for mobile devices is recommended
- Use `prefers-reduced-motion` to disable on user preference

**Recommended Color Schemes (3 Gradients):**

**Gradient 1: Navy â†’ Deep Blue**
```css
linear-gradient(135deg, #0A0E1A 0%, #1A1F3A 50%, #0F1523 100%)
```

**Gradient 2: Navy â†’ Purple Tint**
```css
linear-gradient(225deg, #0A0E1A 0%, #1C1A2E 50%, #131829 100%)
```

**Gradient 3: Navy â†’ Teal Tint**
```css
linear-gradient(315deg, #0A0E1A 0%, #0F2322 50%, #1A1F3A 100%)
```

**Implementation:**
```tsx
// components/AnimatedGradientBg.tsx
export function AnimatedGradientBg() {
  return (
    <div className="fixed inset-0 -z-10 overflow-hidden">
      <div className="gradient-layer gradient-layer-1" />
      <div className="gradient-layer gradient-layer-2" />
      <div className="gradient-layer gradient-layer-3" />
    </div>
  );
}
```

**Sources:**
- [Gradient Animation Trick](https://codersblock.com/blog/gradient-animation-trick/)
- [CSS Animated Gradient Examples](https://www.sliderrevolution.com/resources/css-animated-gradient/)
- [Dark Gradient Background](https://www.frontendgeek.com/tools/css/dark-gradient-background)

---

## 7. Typography System

### 7.1 Recommended Font Pairing

**Requirement:** Distinctive display/geometric font for headings paired with clean body font.

**Research Findings (2026 Typography Trends):**

**Popular Geometric Display + Clean Body Combinations:**

1. **Montserrat (Bold) + Lato (Body)**
   - Montserrat: Geometric sans-serif, bold, modern
   - Lato: Neutral, friendly, high legibility
   - Pairing: Bold headings over calm body text

2. **Poppins (Headings) + Roboto (Body)**
   - Poppins: Geometric, rounded, bold
   - Roboto: Neutral, mechanical, built for UI
   - Pairing: Modern, approachable, versatile

3. **Josefin Sans (Headings) + Lato (Body)**
   - Josefin Sans: Geometric, elegant, refined
   - Lato: Friendly, minimalist
   - Pairing: Modern, professional

4. **Nohemi (Display) + Inter (Body)** (2026 Trend)
   - Nohemi: Geometric sans-serif, condensed, optical refinement
   - Inter: Clean, optimized for screens
   - Pairing: Contemporary, mobile-first

**Recommended for SALGA Trust Engine:**

**Option A: Space Grotesk + Inter** (Recommended)
```css
/* Headings */
@import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@600;700&display=swap');

/* Body */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap');

:root {
  --font-display: 'Space Grotesk', sans-serif;
  --font-body: 'Inter', sans-serif;
}
```

**Why Space Grotesk:**
- Geometric, distinctive, modern
- Excellent readability even at large sizes
- Pairs beautifully with Inter (both are tech-forward)
- Free and open-source

**Option B: Clash Display + Inter** (If budget allows)
```typescript
// More premium option (requires license)
--font-display: 'Clash Display', sans-serif;
--font-body: 'Inter', sans-serif;
```

**Typography Scale:**
```css
:root {
  /* Headings */
  --text-h1: clamp(2.5rem, 5vw, 4rem);    /* 40-64px */
  --text-h2: clamp(2rem, 4vw, 3rem);      /* 32-48px */
  --text-h3: clamp(1.5rem, 3vw, 2rem);    /* 24-32px */
  --text-h4: clamp(1.25rem, 2.5vw, 1.5rem); /* 20-24px */

  /* Body */
  --text-base: 1rem;        /* 16px */
  --text-lg: 1.125rem;      /* 18px */
  --text-sm: 0.875rem;      /* 14px */
  --text-xs: 0.75rem;       /* 12px */

  /* Line heights */
  --leading-tight: 1.2;
  --leading-normal: 1.5;
  --leading-relaxed: 1.75;
}
```

**Sources:**
- [Font Pairing Ultimate Guide](https://www.canva.com/learn/the-ultimate-guide-to-font-pairing/)
- [39 Font Pairings Figma](https://www.figma.com/resource-library/font-pairings/)
- [Typography Trends 2026](https://medium.com/@sellsuiteshop/15-designer-approved-picks-fonts-that-define-typography-trends-2026-583e6ef8ab49)

---

## 8. South African Design Inspiration

### 8.1 Ndebele & Zulu Geometric Patterns

**Research Findings:**

**Ndebele House Painting:**
- Predominantly practiced by Southern Ndebele women
- Colorful geometric patterns and shapes on house exteriors
- Main colors: red, dark red, yellow/gold, sky blue, green, pink
- Patterns drawn with black outline, then filled with color
- Characteristic symmetry and straight edges done by hand (no rulers)

**Meaning:**
- Colors have intensified symbolic meaning
- Can represent status, power, prayer, marriage announcements, or protests
- Patterns inspired by beadwork traditions

**Contemporary Design Applications:**
- South African designer Siyanda Mbele creates furniture inspired by Ndebele patterns
- Patterns provide inspiration for modern, refreshing designs
- Used on desks, home decor, textiles

**How to Apply to SALGA Trust Engine:**

**Subtle Accents (Not Overwhelming):**
1. **Section Dividers:** Thin geometric border patterns between landing page sections
2. **Background Textures:** Faint Ndebele-inspired patterns on card backgrounds (10% opacity)
3. **Decorative Elements:** Corner ornaments on glassmorphism cards
4. **Loading States:** Geometric animation patterns while data loads

**Implementation:**
```css
.section-divider {
  background-image: url('/assets/patterns/ndebele-border.svg');
  background-repeat: repeat-x;
  height: 8px;
  opacity: 0.3;
}

.glass-card::before {
  content: '';
  position: absolute;
  top: 0;
  right: 0;
  width: 100px;
  height: 100px;
  background-image: url('/assets/patterns/zulu-geometric.svg');
  opacity: 0.05;
}
```

**Color Palette Integration:**
- Current coral (#FF6B4A) aligns with Ndebele red/orange
- Current teal (#00D9A6) complements Ndebele blue/green
- Add yellow/gold accent (#FBBF24) as tertiary color inspired by Ndebele palette

**Sources:**
- [Ndebele House Painting Wikipedia](https://en.wikipedia.org/wiki/Ndebele_house_painting)
- [Ndebele Patterns Design Indaba](https://www.designindaba.com/articles/creative-work/zulu-and-ndebele-patterns-solid-wood-desks)
- [Ndebele Tribe Geometric Art](https://elephant.art/reinventing-resistance-the-ndebele-tribes-geometric-wall-art/)

### 8.2 Pattern Asset Recommendations

**Free/Open-Source Pattern Libraries:**
- Search "Ndebele patterns SVG" on free vector sites (Freepik, Vecteezy)
- Create custom SVG patterns inspired by reference images
- Use Figma/Illustrator to trace and simplify patterns
- Export as optimized SVG (< 5KB per pattern)

**Pattern Types Needed:**
1. Horizontal border pattern (for section dividers)
2. Corner ornament (for card decorations)
3. Repeating background texture (for subtle backgrounds)

---

## 9. Interactive Heatmap Implementation

### 9.1 Current Stack (Phase 6.1)

**Existing Libraries:**
- react-leaflet ^5.0.0
- react-leaflet-heatmap-layer-v3 ^3.0.3-beta-1
- leaflet ^1.9
- leaflet.heat ^0.2.0

**Current Implementation:**
- Basic heatmap on public dashboard
- Shows ticket density across municipalities

### 9.2 Enhancement Requirements (Phase 6.2)

**Full Interactivity Needed:**
- Zoom and pan controls
- Click clusters to see category breakdown
- Time filter slider (show tickets from last 30/60/90 days)
- Toggle by issue type (potholes, water, electricity, etc.)

**Implementation Pattern:**

```typescript
import { MapContainer, TileLayer, useMap } from 'react-leaflet';
import HeatmapLayer from 'react-leaflet-heatmap-layer-v3';

function InteractiveHeatmap({ tickets }: { tickets: Ticket[] }) {
  const [timeFilter, setTimeFilter] = useState(30); // days
  const [issueTypeFilter, setIssueTypeFilter] = useState<string[]>(['all']);

  // Filter tickets based on controls
  const filteredTickets = useMemo(() => {
    const cutoffDate = new Date();
    cutoffDate.setDate(cutoffDate.getDate() - timeFilter);

    return tickets.filter(ticket => {
      const matchesTime = new Date(ticket.created_at) >= cutoffDate;
      const matchesType = issueTypeFilter.includes('all') ||
                          issueTypeFilter.includes(ticket.category);
      return matchesTime && matchesType;
    });
  }, [tickets, timeFilter, issueTypeFilter]);

  // Convert to heatmap points
  const heatmapPoints = filteredTickets.map(ticket => ({
    lat: ticket.location.lat,
    lng: ticket.location.lng,
    intensity: 1.0,
  }));

  return (
    <div className="heatmap-container">
      {/* Controls */}
      <div className="heatmap-controls">
        <label>
          Time Range:
          <input
            type="range"
            min={7}
            max={365}
            value={timeFilter}
            onChange={(e) => setTimeFilter(Number(e.target.value))}
          />
          <span>{timeFilter} days</span>
        </label>

        <div className="issue-type-filters">
          {issueTypes.map(type => (
            <label key={type}>
              <input
                type="checkbox"
                checked={issueTypeFilter.includes(type)}
                onChange={() => toggleIssueType(type)}
              />
              {type}
            </label>
          ))}
        </div>
      </div>

      {/* Map */}
      <MapContainer
        center={[-28.4793, 24.6727]} // South Africa center
        zoom={6}
        style={{ height: '600px', width: '100%' }}
      >
        <TileLayer
          url="https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png"
          attribution='&copy; OpenStreetMap contributors'
        />

        <HeatmapLayer
          points={heatmapPoints}
          longitudeExtractor={(point) => point.lng}
          latitudeExtractor={(point) => point.lat}
          intensityExtractor={(point) => point.intensity}
          gradient={{
            0.0: colors.teal,
            0.5: '#FBBF24', // Yellow
            1.0: colors.coral,
          }}
          max={3.0}
          radius={20}
          blur={15}
        />
      </MapContainer>
    </div>
  );
}
```

**Click-to-Drill Pattern:**
```typescript
// When user clicks a cluster, show breakdown popup
function HeatmapClusterPopup({ cluster }: { cluster: TicketCluster }) {
  return (
    <Popup>
      <h4>{cluster.municipalityName}</h4>
      <ul>
        {cluster.categoryCounts.map(({ category, count }) => (
          <li key={category}>
            {category}: {count} tickets
          </li>
        ))}
      </ul>
    </Popup>
  );
}
```

**Sources:**
- [React Leaflet Heatmap Layer](https://github.com/OpenGov/react-leaflet-heatmap-layer)
- [Leaflet Heatmap Best Practices](https://handsondataviz.org/leaflet-heatmap.html)
- [Interactive Maps in React with Leaflet](https://blog.openreplay.com/interactive-maps-in-react-with-leaflet/)

---

## 10. Skeleton Loaders & Loading States

### 10.1 Skeleton Loader Design Principles

**What Are Skeleton Loaders:**
Skeleton loaders are placeholders that mimic the content being loaded, looking like the "content's bones." They minimize wait time frustration while ensuring a stable and visually smooth UI.

**When to Use:**
- Use when loading content takes longer than 1 second
- Use when there are multiple content elements loading simultaneously
- Use to hint at the structure of information in a layout

**Design Best Practices (from research):**
- Simple shapes represent different content types
- Each shape should represent content in a recognizable way
  - Long rectangle for a line of text
  - Circle for an avatar
  - Square for an image
- Sliding effect: Light beam flows from left to right on gray background (shimmer effect)

### 10.2 React Implementation

**Recommended Library: react-loading-skeleton**

**Why:**
- Automatically sizes to correct dimensions (matches font size, line height)
- No need to manually craft skeleton that matches layout
- Loading state remains up-to-date with layout changes

**Implementation:**
```tsx
import Skeleton from 'react-loading-skeleton';
import 'react-loading-skeleton/dist/skeleton.css';

// Card skeleton
function TicketCardSkeleton() {
  return (
    <div className="glass-card p-4">
      <Skeleton width={200} height={24} /> {/* Title */}
      <Skeleton count={2} /> {/* Description lines */}
      <div className="flex gap-4 mt-4">
        <Skeleton width={80} height={32} /> {/* Button */}
        <Skeleton width={80} height={32} /> {/* Button */}
      </div>
    </div>
  );
}

// Table skeleton
function TicketTableSkeleton({ rows = 5 }: { rows?: number }) {
  return (
    <table>
      <thead>
        <tr>
          <th><Skeleton width={100} /></th>
          <th><Skeleton width={150} /></th>
          <th><Skeleton width={100} /></th>
        </tr>
      </thead>
      <tbody>
        {Array.from({ length: rows }).map((_, i) => (
          <tr key={i}>
            <td><Skeleton /></td>
            <td><Skeleton /></td>
            <td><Skeleton /></td>
          </tr>
        ))}
      </tbody>
    </table>
  );
}
```

**Custom Skeleton Theme (Dark Mode):**
```tsx
import { SkeletonTheme } from 'react-loading-skeleton';

<SkeletonTheme
  baseColor="rgba(255,255,255,0.05)"
  highlightColor="rgba(255,255,255,0.1)"
>
  <TicketCardSkeleton />
</SkeletonTheme>
```

**Sources:**
- [React Loading Skeleton npm](https://www.npmjs.com/package/react-loading-skeleton)
- [Skeleton Loader Do's and Don'ts](https://ironeko.com/posts/the-dos-and-donts-of-skeleton-loading-in-react)
- [Implementing Skeleton Screens in React](https://www.smashingmagazine.com/2020/04/skeleton-screens-react/)

---

## 11. Page Structure & Information Architecture

### 11.1 Public Site Structure (4 Pages)

**Pages:**
1. **Landing Page** (`/`)
   - Marketing hero with 3D globe
   - Scroll storytelling sections
   - CTA button: "View Municipal Performance"

2. **Transparency Dashboard** (`/dashboard`)
   - Separate dedicated page (NOT embedded in landing)
   - Interactive SA map with municipality selection
   - Progressive disclosure: click-to-expand panels
   - Side-by-side comparison + ranked leaderboard
   - Interactive heatmap with filters

3. **Report an Issue** (`/report`)
   - Redirects to municipal dashboard login
   - Message: "Please log in to report an issue"
   - "Don't have an account? Register"

4. **About / How It Works** (`/about`)
   - Explains SALGA Trust Engine
   - Process overview
   - Benefits for citizens and municipalities
   - FAQ section

**Navigation Structure:**
```tsx
// Public site header
<nav>
  <Logo />
  <NavLinks>
    <NavLink to="/">Home</NavLink>
    <NavLink to="/dashboard">Dashboard</NavLink>
    <NavLink to="/about">About</NavLink>
  </NavLinks>
  <CTAButton to="/report">Report Issue</CTAButton>
</nav>
```

### 11.2 Municipal Dashboard Structure (Role-Adaptive)

**Pages (Manager Role - Full Access):**
1. **Login/Register** (`/login`, `/register`)
2. **Onboarding Wizard** (`/onboarding`)
3. **Dashboard Home** (`/`) â€” Metrics overview
4. **Tickets** (`/tickets`) â€” Full ticket list with filters
5. **Teams** (`/teams`) â€” Team management
6. **Settings** (`/settings`) â€” Municipality configuration
7. **Analytics** (`/analytics`) â€” Performance reports

**Navigation Pattern:**
- Icon-only sidebar (collapsed by default)
- Hover to expand and show labels
- Mobile: hamburger menu
- Role badge in user profile dropdown

**Adaptive Views:**
- Manager: All pages visible
- Ward Councillor: Dashboard, Tickets (ward-filtered), Analytics (ward-filtered)
- Field Worker: Dashboard (My Tickets), Submit Report
- SAPS Liaison: Dashboard (GBV Cases), Reports

---

## 12. Civic Tech Privacy & Security UI Patterns

### 12.1 GBV Case Visibility Design

**Challenge:** Balance transparency with victim safety.

**Solution (from research):**
- Civic dashboards should never reveal personal information, internal notes, or sensitive details
- Role-based access ensures public pages only include approved fields
- GBV cases require special privacy considerations

**Implementation for Citizen "My Reports" Page:**

```tsx
function TicketListItem({ ticket }: { ticket: Ticket }) {
  if (ticket.is_sensitive) {
    // GBV Case - Limited info
    return (
      <GlassCard className="gbv-case-card">
        <div className="flex items-center gap-2">
          <ShieldAlertIcon className="text-red-500" />
          <h3>GBV Case (Private)</h3>
          <LockIcon className="ml-auto text-gray-400" />
        </div>

        <div className="case-info mt-4">
          <InfoRow label="Status" value={ticket.status} />
          <InfoRow label="Assigned SAPS Officer" value={ticket.assigned_officer_name} />
          <InfoRow label="Police Station" value={ticket.station_name} />
          <InfoRow label="Contact" value={ticket.station_phone} />
        </div>

        <div className="emergency-contacts mt-4 p-4 bg-red-900/20 rounded-lg">
          <p className="font-semibold">Emergency Contacts</p>
          <p>Police: <a href="tel:10111">10111</a></p>
          <p>GBV Helpline: <a href="tel:0800150150">0800 150 150</a></p>
        </div>

        <Button variant="outline" disabled>
          Details Hidden for Privacy
        </Button>
      </GlassCard>
    );
  }

  // Regular municipal ticket - Full details
  return (
    <GlassCard>
      <h3>{ticket.title}</h3>
      <p>{ticket.description}</p>
      <InfoRow label="Assigned to" value={ticket.assigned_team_member} />
      <InfoRow label="Photos" value={`${ticket.media_count} attachments`} />
      <Button onClick={() => viewDetails(ticket.id)}>
        View Full Details
      </Button>
    </GlassCard>
  );
}
```

**Why This Design:**
- Empowers victim to track case status
- Provides direct contact for follow-up with assigned officer
- Maintains privacy (no address, no photos, no case details)
- Emergency contacts always prominently displayed
- Clear visual distinction (lock icon, different card styling)

**Sources:**
- [Civic Dashboard Transparency](https://folioprojects.com/blog/civic-dashboard-public-projects-transparency)
- [Dashboard UX Patterns Best Practices](https://www.pencilandpaper.io/articles/ux-pattern-analysis-data-dashboards)

---

## 13. Technical Implementation Roadmap

### 13.1 Shared Component Library Setup

**Step 1: Create Shared Directory Structure**
```
shared/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”‚   â”œâ”€â”€ GlassCard.tsx
â”‚   â”‚   â”œâ”€â”€ Skeleton.tsx
â”‚   â”‚   â”œâ”€â”€ Input.tsx
â”‚   â”‚   â”œâ”€â”€ Select.tsx
â”‚   â”‚   â”œâ”€â”€ Dialog.tsx
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ Globe3D.tsx (reusable 3D globe)
â”‚   â””â”€â”€ AnimatedGradientBg.tsx
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ utils.ts (cn function, etc.)
â”‚   â””â”€â”€ animations.ts (GSAP helpers)
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useRoleBasedNav.ts
â”‚   â””â”€â”€ useProgressiveDisclosure.ts
â”œâ”€â”€ design-tokens.css
â””â”€â”€ tokens.ts
```

**Step 2: Install Shared Dependencies**
```bash
# Add to both frontend-dashboard and frontend-public
npm install react-loading-skeleton
npm install class-variance-authority clsx tailwind-merge
```

**Step 3: Configure TypeScript Paths**
```json
// tsconfig.json (both apps)
{
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@shared/*": ["../../../shared/*"],
      "@/components/*": ["./src/components/*"],
      "@/lib/*": ["./src/lib/*"]
    }
  }
}
```

### 13.2 Component Migration Strategy

**Phase 1: Extract Existing Components to Shared**
- Move Globe3D from both apps to `shared/components/`
- Extract glassmorphism login card pattern to `shared/components/ui/GlassCard.tsx`
- Move design tokens from inline styles to `shared/design-tokens.css`

**Phase 2: Build New Shared Components**
- Create shadcn/ui-inspired components (Button, Input, etc.)
- Build skeleton loaders
- Create onboarding wizard components

**Phase 3: Implement Role-Based Navigation**
- Build `useRoleBasedNav` hook
- Create adaptive sidebar component
- Wire up role detection from Supabase Auth

**Phase 4: Enhance 3D Globe**
- Upgrade materials to MeshPhysicalMaterial
- Add particle effects for municipality points
- Implement LOD for mobile optimization

**Phase 5: Build User Journey Flows**
- Municipality registration request form
- Onboarding wizard with progress tracking
- Citizen registration flow (web + WhatsApp)
- "My Reports" authenticated citizen dashboard

### 13.3 Testing Strategy

**Component Testing:**
- Unit tests for shared components using React Testing Library
- Storybook for component documentation and visual testing
- Accessibility testing with axe-core

**User Journey Testing:**
- E2E tests with Playwright for critical flows
- Test municipality onboarding wizard completion
- Test citizen registration and report tracking
- Test role-based navigation visibility

**Performance Testing:**
- Lighthouse audits for both dashboards
- 3D performance testing on low-end devices
- Bundle size monitoring (target < 300KB for initial load)

---

## 14. Bundle Size & Performance Budget

### 14.1 Current Stack Analysis

**Existing Libraries (Phase 6.1):**
| Package | Size (min+gzip) | Purpose |
|---------|-----------------|---------|
| gsap + ScrollTrigger | ~30KB | Animations |
| @gsap/react | ~2KB | React integration |
| three | ~150KB | 3D rendering |
| @react-three/fiber | ~40KB | React Three.js |
| @react-three/drei | ~Variable | Three.js helpers |
| lenis | ~8KB | Smooth scroll |
| animejs | ~17KB | Micro-interactions |
| detect-gpu | ~3KB | Performance detection |
| react-leaflet | ~10KB | Heatmap |
| leaflet | ~40KB | Map library |
| **Total** | **~300KB** | â€” |

**New Dependencies for Phase 6.2:**
| Package | Size | Purpose |
|---------|------|---------|
| react-loading-skeleton | ~8KB | Skeleton loaders |
| class-variance-authority | ~2KB | Component variants |
| clsx | ~1KB | Class merging |
| **Total New** | **~11KB** | â€” |

**Grand Total: ~311KB** (acceptable for 2026 standards)

### 14.2 Optimization Strategy

**Code Splitting:**
```typescript
// Lazy-load heavy components
const Globe3D = React.lazy(() => import('@shared/components/Globe3D'));
const OnboardingWizard = React.lazy(() => import('./OnboardingWizard'));
const HeatmapViewer = React.lazy(() => import('./HeatmapViewer'));

// Use Suspense with skeleton fallback
<Suspense fallback={<GlobeLoadingSkeleton />}>
  <Globe3D />
</Suspense>
```

**Tree Shaking:**
```typescript
// Import only what you need from Three.js
import { Mesh, BufferGeometry, MeshPhysicalMaterial } from 'three';
// NOT: import * as THREE from 'three';
```

**Preloading Strategy:**
```typescript
// Preload on idle
if ('requestIdleCallback' in window) {
  requestIdleCallback(() => {
    import('./Globe3D');
    import('./OnboardingWizard');
  });
}
```

---

## 15. Key Recommendations Summary

### 15.1 Design System
- **Adopt shadcn/ui + Radix UI + Tailwind CSS** for component architecture
- **Create shared component library** in `shared/components/ui/`
- **Extract glassmorphism pattern** from existing login card as reusable component
- **Use CSS custom properties** for design tokens shared across both apps

### 15.2 User Journeys
- **Municipality: Hybrid registration** (request access â†’ admin approval â†’ invite)
- **Municipality: Multi-step onboarding wizard** with progress tracking (5 steps)
- **Citizen: Unified web + WhatsApp registration** (both create same account)
- **Role-based navigation** with adaptive sidebar for municipal dashboard

### 15.3 3D Elements
- **Upgrade globe materials** to MeshPhysicalMaterial with metalness/clearcoat
- **Add particle effects** for municipality points with AdditiveBlending glow
- **Maintain mobile optimizations** from Phase 6.1 (DPR cap, LOD, lazy loading)
- **Use 3D strategically:** Landing hero + transparency dashboard (NOT municipal dashboard)

### 15.4 Animations
- **Maintain GSAP + Lenis stack** for scroll storytelling
- **Add animated gradient background** (3 color schemes rotating smoothly)
- **Implement prefers-reduced-motion** support for accessibility (WCAG 2.3.3)
- **Use skeleton loaders** with shimmer effect for all loading states

### 15.5 Typography & Design
- **Font pairing: Space Grotesk (display) + Inter (body)** for modern, distinctive look
- **Ndebele/Zulu patterns** as subtle accents (section dividers, card decorations)
- **Dark mode palette:** Navy base with animated gradients, coral/teal accents
- **Add yellow/gold tertiary color** (#FBBF24) inspired by Ndebele palette

### 15.6 Interactive Features
- **Enhanced heatmap:** Zoom, pan, click clusters, time filter, category toggle
- **Progressive disclosure:** Click-to-expand panels on transparency dashboard
- **Municipality comparison:** Side-by-side AND ranked leaderboard views
- **GBV privacy UI:** Lock icon, limited info, prominent emergency contacts

---

## 16. Research Sources

### Design Systems & Component Architecture
- [Shadcn UI Foundation](https://ui.shadcn.com/)
- [TypeScript with React Best Practices 2026](https://medium.com/@mernstackdevbykevin/typescript-with-react-best-practices-2026-78ce4546210b)
- [Building Reusable React Components 2026](https://medium.com/@romko.kozak/building-reusable-react-components-in-2026-a461d30f8ce4)
- [React UI with Radix + Tailwind](https://vercel.com/academy/shadcn-ui)
- [Shadcn UI Best Practices 2026](https://medium.com/write-a-catalyst/shadcn-ui-best-practices-for-2026-444efd204f44)

### Glassmorphism
- [Liquid Glass UI](https://liquidglass.liqueai.com/)
- [glasscn-ui GitHub](https://github.com/itsjavi/glasscn-ui)
- [Glassmorphism in 2026](https://invernessdesignstudio.com/glassmorphism-what-it-is-and-how-to-use-it-in-2026)

### User Journey Mapping
- [Citizen Journey Mapping in Government](https://www.smaply.com/blog/journey-mapping-government)
- [Journey Mapping in State and Local Government](https://statetechmagazine.com/article/2024/08/what-journey-mapping-and-how-it-used-state-and-local-government-perfcon)
- [Nivaro: Simplifying Civic Reporting](https://medium.com/dtalks/nivaro-how-i-simplified-civic-reporting-for-millions-a-ui-ux-design-story-ba9c4243c0cd)

### Progressive Disclosure & Onboarding
- [Progressive Disclosure Examples](https://userpilot.com/blog/progressive-disclosure-examples/)
- [Progressive Disclosure in UX Design](https://blog.logrocket.com/ux-design/progressive-disclosure-ux-types-use-cases/)
- [UX Onboarding Best Practices 2026](https://www.uxdesigninstitute.com/blog/ux-onboarding-best-practices-guide/)
- [Progressive Onboarding Guide](https://userguiding.com/blog/progressive-onboarding)

### 3D Visualization
- [React-Globe.gl](https://github.com/vasturiano/react-globe.gl)
- [Three-Globe npm](https://www.npmjs.com/package/three-globe)
- [Make Your Own Earth in Three.js](https://franky-arkon-digital.medium.com/make-your-own-earth-in-three-js-8b875e281b1e)
- [R3F Scaling Performance](https://r3f.docs.pmnd.rs/advanced/scaling-performance)

### GSAP & Scroll Animations
- [Cinematic 3D Scroll with GSAP](https://tympanus.net/codrops/2025/11/19/how-to-build-cinematic-3d-scroll-experiences-with-gsap/)
- [Scroll Storytelling Web Design Trend 2026](https://www.skyadesigns.co.uk/web-design-insights/web-design-trend-2026-scroll-storytelling/)
- [GSAP Scroll Documentation](https://gsap.com/scroll/)

### Accessibility
- [Animation & Motion Accessibility](https://www.atomica11y.com/accessible-design/animation/)
- [WCAG 2.3.3 Animation from Interactions](https://www.w3.org/WAI/WCAG21/Understanding/animation-from-interactions.html)
- [CSS prefers-reduced-motion](https://www.w3.org/WAI/WCAG21/Techniques/css/C39)

### Dark Mode & Gradients
- [Gradient Animation Trick](https://codersblock.com/blog/gradient-animation-trick/)
- [CSS Animated Gradient Examples](https://www.sliderrevolution.com/resources/css-animated-gradient/)
- [Dark Gradient Background](https://www.frontendgeek.com/tools/css/dark-gradient-background)

### Typography
- [Font Pairing Ultimate Guide](https://www.canva.com/learn/the-ultimate-guide-to-font-pairing/)
- [39 Font Pairings Figma](https://www.figma.com/resource-library/font-pairings/)
- [Typography Trends 2026](https://medium.com/@sellsuiteshop/15-designer-approved-picks-fonts-that-define-typography-trends-2026-583e6ef8ab49)

### South African Design
- [Ndebele House Painting Wikipedia](https://en.wikipedia.org/wiki/Ndebele_house_painting)
- [Ndebele Patterns Design Indaba](https://www.designindaba.com/articles/creative-work/zulu-and-ndebele-patterns-solid-wood-desks)
- [Ndebele Tribe Geometric Art](https://elephant.art/reinventing-resistance-the-ndebele-tribes-geometric-wall-art/)

### Interactive Maps
- [React Leaflet Heatmap Layer](https://github.com/OpenGov/react-leaflet-heatmap-layer)
- [Leaflet Heatmap Best Practices](https://handsondataviz.org/leaflet-heatmap.html)
- [Interactive Maps in React with Leaflet](https://blog.openreplay.com/interactive-maps-in-react-with-leaflet/)

### Skeleton Loaders
- [React Loading Skeleton npm](https://www.npmjs.com/package/react-loading-skeleton)
- [Skeleton Loader Do's and Don'ts](https://ironeko.com/posts/the-dos-and-donts-of-skeleton-loading-in-react)
- [Implementing Skeleton Screens in React](https://www.smashingmagazine.com/2020/04/skeleton-screens-react/)

### Role-Based Dashboards
- [React Admin Dashboard 2026 Guide](https://refine.dev/blog/react-admin-dashboard/)
- [Role-Based Menu in React](https://www.sevensquaretech.com/role-based-menu-reactjs-with-github-code/)

### Civic Tech Privacy
- [Civic Dashboard Transparency](https://folioprojects.com/blog/civic-dashboard-public-projects-transparency)
- [Dashboard UX Patterns Best Practices](https://www.pencilandpaper.io/articles/ux-pattern-analysis-data-dashboards)

---

## RESEARCH COMPLETE

**Date:** 2026-02-11
**Status:** Ready for planning

All research areas completed. Key findings documented with implementation patterns and source citations. Next step: Create detailed execution plans (06.2-01-PLAN.md, etc.).
