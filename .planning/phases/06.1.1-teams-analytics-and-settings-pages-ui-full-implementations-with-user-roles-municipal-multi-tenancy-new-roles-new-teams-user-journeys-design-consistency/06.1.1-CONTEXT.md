# Phase 06.1.1: Teams, Analytics & Settings Pages UI - Context

**Gathered:** 2026-02-19
**Status:** Ready for planning

<domain>
## Phase Boundary

Replace the "Coming Soon" placeholders for Teams, Analytics, and Settings pages in the municipal dashboard (frontend-dashboard/) with full implementations. All three pages must respect existing RBAC roles, municipal multi-tenancy, and match the established glassmorphic design system (GlassCard, design tokens, pink/rose theme, Space Grotesk + Inter typography). Backend API endpoints for teams, invitations, dashboard metrics, SLA config, and audit logs already exist — this phase is primarily frontend UI work connecting to existing infrastructure.

Scope: Teams page, Analytics page, Settings page, role management UX integrated into Teams.
NOT in scope: New backend endpoints, new database models, custom role creation, Municipalities page, System page, Reports page.

</domain>

<decisions>
## Implementation Decisions

### Teams Page — Layout & Display
- Card grid layout — each team rendered as a GlassCard
- Card shows: team name, category badge (icon + colored pill), member count, manager name, active ticket count
- Category icons per service type (water, electricity, roads, waste, sanitation, GBV, other) with unique accent colors
- Both icon AND colored badge together for strong visual category distinction
- Create team via inline "+" card in the grid — expands into a creation form (name, category dropdown, service area, assign manager)

### Teams Page — Team Detail
- Clicking a team card opens a full detail MODAL (not page navigation, not inline expand)
- Modal has tabbed layout: Members | Pending Invitations | Activity
- Members tab shows active team members with role badges
- Pending Invitations tab shows sent invitations with status and resend/cancel actions

### Teams Page — Member Management
- Quick single invite: inline email + role form within the team detail modal
- Bulk invite: separate "Bulk Invite" button opens a batch dialog (multi-line email input + role selector)
- Both invitation paths available — quick for one-off, bulk for onboarding
- Managers can remove members from team AND have option to deactivate user accounts (admin-level action with confirmation)
- Role assignment happens contextually when inviting or editing members on the Teams page

### Analytics Page — Scope & Data
- Full analytics suite: time-series trends AND cross-dimensional comparisons
- Trends: ticket volume, SLA compliance, resolution rates over configurable time periods
- Comparisons: performance across teams, categories, wards — identify bottlenecks and top performers
- Time range controls: preset buttons (7d, 30d, 90d, 6mo, 1yr) PLUS custom date range picker

### Analytics Page — Visualization Approach
- Mixed approach prioritizing clarity over chart complexity:
  - Top-level KPIs as large stat cards with inline sparklines (Stripe/Linear dashboard style)
  - Team/category comparisons as horizontal bar rankings with progress bars and trend arrows (leaderboard style)
  - Minimal traditional charts — only where sparklines and bars are insufficient
- IMPORTANT: Claude historically struggles with chart/pie implementations — be careful and thoughtful with any Recharts usage, keep visualizations simple and data-dense rather than visually complex
- Ward councillor analytics view filtered to their ward (existing backend support via ward_id param)

### Settings Page — Structure & Organization
- Single scrollable page with clearly separated sections + anchor navigation at top
- Full settings suite exposed:
  - Municipality profile (name, logo, contact info)
  - SLA targets (response/resolution hours per category)
  - Notification preferences
  - Team defaults
  - Ward boundaries
  - Branding/logo
  - Data export
  - Audit log viewer
- Each section has explicit Save button — changes don't auto-save
- Role-based visibility: some sections admin-only, some manager-accessible

### Role Management — Approach
- Fixed 6 system roles (citizen, field_worker, manager, ward_councillor, admin, saps_liaison) — no custom role creation
- Municipalities can set display labels for roles (e.g., "Manager" -> "Department Head") for local context
- Role management lives on the Teams page, integrated contextually when managing members
- Permission matrix: visual grid showing role x capability with checkmarks (view tickets, assign, export, manage teams, etc.)
- Role assignment includes preview + confirm step: after selecting role, show brief permission summary before confirming — prevents accidental over-privilege

### Claude's Discretion
- Audit log placement: inline preview on Settings page vs separate /audit route — decide based on page complexity
- Exact sparkline library choice (lightweight options preferred)
- Analytics page section ordering and grouping
- Team detail modal sizing and responsive behavior
- Empty states for each page (no teams yet, no analytics data yet, etc.)
- Loading skeleton patterns per page
- Export functionality on Analytics page (PDF/CSV of analytics data)
- Mobile responsive adaptations for all three pages

</decisions>

<specifics>
## Specific Ideas

- Team cards should match the existing MetricsCards pattern (AnimatedCard wrapper + GlassCard) for visual consistency
- Analytics stat cards should feel like Stripe's dashboard — large numbers, small sparklines, clean typography
- Team leaderboards should use horizontal bars (not vertical) for easy scanning of ranked performance
- All modals should use glassmorphic styling consistent with existing onboarding wizard dialogs
- Category color mapping must be consistent between Teams page badges and Analytics comparisons
- Permission matrix should be read-only for managers, editable display labels for admins only

</specifics>

<deferred>
## Deferred Ideas

- Municipalities page (/municipalities) — platform_admin management of municipalities (separate phase)
- System page (/system) — system-wide administration for platform_admin (separate phase)
- Reports page (/reports) — SAPS liaison reports dashboard (separate phase)
- Custom role creation with granular permissions — noted for future if municipalities need beyond 6 roles
- Real-time analytics updates via Supabase Realtime (current phase uses fetch-on-load + manual refresh)

</deferred>

---

*Phase: 06.1.1-teams-analytics-settings*
*Context gathered: 2026-02-19*
